df_unreg <- do.call(rbind, lapply(res_list[[2]], get_solution_from_res))
df_list <- lapply(res_list, function(x) do.call(rbind, lapply(x, get_solution_from_res)))
res_list
# format data and compare results
df_list <- lapply(res_list, function(x) do.call(rbind, lapply(x, get_solution_from_res)))
df_list
df_true <- do.call(rbind, lapply(full_dat, function(x) get_par_from_rate_mat(x, index_mat)))
ntips <- do.call(rbind, lapply(full_dat, function(x) length(x$phy$tip.label)))
ntips
df_true
df_list
df_true_long <- get_better_df(df_true, colnames(tmp), "true", ntips)
df_true_long
length(df_list)
df_long_list <- list()
names(res_list)
df_long_list <- list()
for(i in 1:length(df_list)){
df_long_list[[i]] <- get_better_df(df_list[[i]], colnames(tmp), names(res_list)[i], ntips)
}
df_long_list
df_long_list[[i]]$value
df_true_long <- get_better_df(df_true, colnames(tmp), "true", ntips)
df_long_list <- list()
for(i in 1:length(df_list)){
df_long_list[[i]] <- get_better_df(df_list[[i]], colnames(tmp), names(res_list)[i], ntips)
df_long_list[[i]]$diff <- df_long_list[[i]]$value - df_true_long$value
}
df_long_list
do.call(rbind, df_long_list)
df_all <- do.call(rbind, df_long_list)
df_all
# Calculate MSE and RMSE for df_reg_diff
df_summary <- df_all %>%
group_by(type, par, ntips) %>%
summarize(
mean_diff_reg = mean(diff),
var_diff_reg = var(diff),
mse_reg = mean(diff^2),  # Calculate MSE
rmse_reg = sqrt(mse_reg)     # Calculate RMSE
)
df_summary
# Calculate MSE and RMSE for df_reg_diff
df_summary <- df_all %>%
group_by(par, ntips, type) %>%
summarize(
mean_diff_reg = mean(diff),
var_diff_reg = var(diff),
mse_reg = mean(diff^2),  # Calculate MSE
rmse_reg = sqrt(mse_reg)     # Calculate RMSE
)
df_summary
# Calculate MSE and RMSE for df_reg_diff
df_summary <- df_all %>%
group_by(par, ntips, type) %>%
summarize(
bias = mean(diff),
var = var(diff),
mse= mean(diff^2),  # Calculate MSE
rmse = sqrt(mse_reg)     # Calculate RMSE
)
# Calculate MSE and RMSE for df_reg_diff
df_summary <- df_all %>%
group_by(par, ntips, type) %>%
summarize(
bias = mean(diff),
var = var(diff),
mse= mean(diff^2),  # Calculate MSE
rmse = sqrt(mse)     # Calculate RMSE
)
df_summary
print(df_summary)
# Calculate MSE and RMSE for df_reg_diff
df_summary <- df_all %>%
group_by(type, par, ntips) %>%
summarize(
bias = mean(diff),
var = var(diff),
mse= mean(diff^2),  # Calculate MSE
rmse = sqrt(mse)     # Calculate RMSE
)
print(df_summary)
# Calculate MSE and RMSE for df_reg_diff
df_summary <- df_all %>%
group_by(ntips, type, par) %>%
summarize(
bias = mean(diff),
var = var(diff),
mse= mean(diff^2),  # Calculate MSE
rmse = sqrt(mse)     # Calculate RMSE
)
print(df_summary)
0.542^2
ggplot(df_summary, aes(x = factor(ntips), y = bias, fill = par)) +
geom_boxplot() +
facet_grid(.~type) +
labs(x = "ntips", y = "Bias") +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_summary, aes(x = factor(type), y = bias, fill = par)) +
geom_boxplot() +
facet_grid(~ntips) +
labs(x = "ntips", y = "Bias") +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
df_summary
df_all
ggplot(df_all, aes(x = factor(type), y = bias, fill = par)) +
geom_boxplot() +
facet_grid(~ntips) +
labs(x = "ntips", y = "Bias") +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
df_all
ggplot(df_all, aes(x = factor(type), y = diff, fill = par)) +
geom_boxplot() +
facet_grid(~ntips) +
labs(x = "ntips", y = "Bias") +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(type), y = diff, fill = par)) +
geom_boxplot() +
facet_grid(ntips~.) +
labs(x = "ntips", y = "Bias") +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(type), y = diff, fill = par)) +
geom_boxplot() +
facet_grid(ntips~.) +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(type), y = log(diff), fill = par)) +
geom_boxplot() +
facet_grid(ntips~.) +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(type), y = diff, fill = par)) +
geom_boxplot() +
facet_grid(ntips~.) +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type)) +
geom_boxplot() +
facet_grid(ntips~.) +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_boxplot() +
facet_grid(ntips~.) +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin() +
facet_grid(ntips~.) +
scale_fill_manual(values = c("(1)_(2)" = "red", "(2)_(1)" = "blue")) +
theme_minimal()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin() +
facet_grid(ntips~.) +
theme_minimal()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin() +
facet_grid(ntips~.) +
coord_cartesian(ylim=c(0, 10))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin() +
facet_grid(ntips~.) +
coord_cartesian(ylim=c(-10, 10))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin() +
facet_grid(ntips~.) +
coord_cartesian(ylim=c(-5, 5))
source("~/corhmm-dredge/code/utils.R")
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_flat_violin(position = position_nudge(x = -0.175)) +
geom_point(position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, width = 0.25) +
facet_grid(ntips~.)
library(ape)
# Load the package (after installation, see above).
library(optimx)   # optimx seems better than R's default optim()
library(GenSA)    # GenSA seems better than optimx (but slower) on 5+ parameters,
# seems to sometimes fail on simple problems (2-3 parameters)
library(FD)       # for FD::maxent() (make sure this is up-to-date)
library(snow)     # (if you want to use multicore functionality; some systems/R versions prefer library(parallel), try either)
library(parallel)
library(rexpokit)
library(cladoRcpp)
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_flat_violin(position = position_nudge(x = -0.175)) +
geom_point(position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, width = 0.25) +
facet_grid(ntips~.)
library(ape)
library(hisse)
library(parallel)
library(phytools)
library(ggplot2)
library(dplyr)
library(tidyr)
library(ggtree)
library(phylolm)
require(aplot)
library(gridExtra)
library(ggplotify)
library(ggsignif)
library(ggridges)
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_flat_violin(position = position_nudge(x = -0.175)) +
geom_point(position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, width = 0.25) +
facet_grid(ntips~.)
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_flat_violin(position = position_nudge(x = -0.175))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_flat_violin()
source("~/corhmm-dredge/code/utils.R")
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_flat_violin(position = position_nudge(x = -0.175)) +
geom_point(position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, width = 0.25) +
facet_grid(ntips~.)
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_point(position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, width = 0.25) +
facet_grid(ntips~.)
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_point(position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(outlier.shape = NA, width = 0.25)
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type),
position = position_nudge(x = -0.175)) +
geom_point(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type),
position = position_jitter(width = 0.05), alpha = 0.5) +
geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type),
outlier.shape = NA, width = 0.25) +
facet_grid(ntips~.)
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type),
position = position_nudge(x = -0.175))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin(position = position_nudge(x = -0.175))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin(position = position_nudge(x = -0.01))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin() +
facet_grid(ntips~.) +
coord_cartesian(ylim=c(-5, 5))
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin()
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type))
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
coord_cartesian(ylim=c(-5, 5))
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type),
outlier.shape = NA, width = 0.25) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
ggplot() +
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type))
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
# geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
ggplot() +
geom_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
# geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
ggplot() +
geom_flat_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_violin(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
# geom_boxplot(data = df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
coord_cartesian(ylim=c(-5, 5)) +
facet_grid(ntips~.)
library(gghalves)
install.packages("gghalves")
library(gghalves)
n=0.02
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.5, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0)) +
theme_hc()
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.5, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0))
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n)
ggplot(df_all, aes(x = factor(par), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n)
n=0.02
ggplot(iris, aes(Species, Sepal.Length)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.5, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0)) +
theme_hc()
ggplot(iris, aes(Species, Sepal.Length)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.5, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0))
ggplot(iris, aes(Species, Sepal.Length)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE,
width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.5, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0))
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.05, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0))
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.05, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0)) +
coord_cartesian(xlim=c(-5,5))
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_dotplot(dotsize=0.05, alpha=0.3, fill="red",
position=position_nudge(x=n, y=0)) +
coord_cartesian(ylim=c(-5,5))
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5))
df_all
ggplot(df_all, aes(x = factor(type) * ntips, y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5))
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5))
df_all
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(ntips~par)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_hline(yintercept = 0) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_hline(yintercept = 0, color = "red") +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_half_point(center=TRUE, alpha = 0.1) +
geom_hline(yintercept = 0, color = "red") +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n) +
geom_half_point(alpha = 0.1) +
geom_half_violin(side="r", nudge=n) +
geom_hline(yintercept = 0, color = "red") +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.1) +
geom_half_violin(side="r", nudge=n) +
geom_hline(yintercept = 0, color = "red") +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, fill = type, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25, nudge=n) +
geom_half_violin(side="r", nudge=n) +
geom_hline(yintercept = 0, color = "red") +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
geom_hline(yintercept = 0, color = "red") +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="l", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="l", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="l", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.5, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.75, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.75, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-2.5,5)) +
facet_wrap(par~ntips)
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.75, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-3,5)) +
facet_wrap(par~ntips)
n=0.02
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.75, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips)
print(df_summary)
ggsave("plot_01.pdf")
ggplot(df_all, aes(x = factor(type), y = diff, color = type)) +
geom_half_boxplot(center=TRUE, errorbar.draw=FALSE, width=0.75, nudge=n, outlier.colour = NA) +
geom_half_point(alpha = 0.25) +
geom_half_violin(side="r", nudge=n) +
coord_cartesian(ylim=c(-5,5)) +
facet_wrap(par~ntips) +
theme_bw()
