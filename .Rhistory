library(corHMM)
# library(corHMM)
setwd("~/corHMM/")
devtools::load_all()
setwd("~/corhmm-dredge/")
data(primates)
phy <- multi2di(primates[[1]])
phy$edge.length <- phy$edge.length + 1e-7
data <- primates[[2]]
dredge_fits <- corHMMDredge(phy = phy, data = data, max.rate.cat = 1, pen.type = "l1", root.p = "maddfitz", lambda = 1, nstarts = 10, n.cores = 10)
model_table <- getModelTable(dredge_fits)
dredge_model <- dredge_fits[[which.min(model_table$dAIC)]]
k_fold_res <- kFoldCrossValidation(dredge_model, k = 5, lambdas = c(0,0.25,0.5,0.75,1))
cv_table <- getCVTable(k_fold_res)
profile_results_dredge <- get_batch_profile_lik(dredge_model, dredge = TRUE,
range_factor = 100, n_points = 50, verbose = TRUE, ncores = 10)
plot_batch_profile_lik(profile_results_dredge)
corhmm_model <- corHMM(phy, data, 1, model = "ARD", root.p = "maddfitz", collapse = FALSE, nstarts = 10, n.cores = 10)
corhmm_model$index.mat <- dropStateMatPars(corhmm_model$index.mat, c(1,3,4,8))
profile_results_corhmm <- get_batch_profile_lik(corhmm_model, dredge = FALSE,
range_factor = 100, n_points = 50, verbose = TRUE, ncores = 10)
plot_batch_profile_lik(profile_results_corhmm)
corhmm_model
?plot_batch_profile_lik
par(mar=c(.1,.1,.1,.1))
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE)
dev.off()
par(mar=c(.1,.1,.1,.1))
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE)
corhmm_model$states
corhmm_model$tip.states
tiplabels(pie = corhmm_model$tip.states, pie.cex=0.5)
tiplabels(pie = corhmm_model$tip.states, pie.cex=0.25)
tiplabels(pie = corhmm_model$tip.states, cex=0.25)
corHMM::plotRECON
piecolors=c("white","black","red","yellow","forestgreen","blue","coral","aquamarine","darkorchid","gold","grey","yellow","#3288BD","#E31A1C")
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
?corHMM
?corHMMDredge
?get_batch_profile_lik
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON
RColorBrewer::display.brewer.pal()
RColorBrewer::display.brewer.all()
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Spectral")
piecolors
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
RColorBrewer::display.brewer.all()
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Greys")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "YlOrRd")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "YlGnBu")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
piecolors <- RColorBrewer::brewer.pal(4, "YlGnBu")
dev.off()
RColorBrewer::display.brewer.all(
)
piecolors <- RColorBrewer::brewer.pal(4, "RdYlGn")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "RdYlbu")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
piecolors <- RColorBrewer::brewer.pal(4, "RdYlBu")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "RdGy")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "PRGn")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "BrBG")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
piecolors <- RColorBrewer::brewer.pal(4, "Greys")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Pastel1")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Accent")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Dark2")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "PiYG")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
piecolors <- RColorBrewer::brewer.pal(4, "PiYG")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "YlOrRd")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
piecolors=c("white","black","red","yellow","forestgreen","blue","coral","aquamarine","darkorchid","gold","grey","yellow","#3288BD","#E31A1C")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "BrBG")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
corHMM::plotRECON(corhmm_model$phy, corhmm_model$states, pie.cex = 1, show.tip.label = FALSE, direction = "leftwards", piecolors = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Greys")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
corHMM::plotRECON(dredge_model$phy, dredge_model$states, pie.cex = 1, show.tip.label = FALSE, piecolors = piecolors)
plot(dredge_model$phy, show.tip.label = FALSE)
nodelabels(pie = piecolors)
nodelabels(pie = drege_model$states, piecol = piecolors)
drege_model$states
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
nodelabels(pie = dredge_mode$states, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
nodelabels(pie = corhmm_model$states, piecol = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states), pch=21, bg.col = piecolors)
legend("topleft", legend = colnames(dredge_model$states), pch=21, col = piecolors)
legend("topleft", legend = colnames(dredge_model$states), pch=21, pt.col = piecolors)
legend("topleft", legend = colnames(dredge_model$states), pch=21, pt.bg = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.5, bty="n")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
nodelabels(pie = dredge_model$states, piecol = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.5, bty="n")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
nodelabels(pie = dredge_model$states, piecol = piecolors)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
nodelabels(pie = corhmm_model$states, piecol = piecolors)
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "RdYlBu")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Paired")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
corhmm_model
dredge_model$index.mat
corhmm_model_2 <- corHMM(phy, data, 1, rate.mat = dredge_model$index.mat, root.p = "maddfitz", collapse = FALSE, nstarts = 10, n.cores = 10)
corhmm_model_2
corhmm_model
corhmm_model_2
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(corhmm_model_2$phy, show.tip.label = FALSE)
tiplabels(pie = corhmm_model_2$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model_2$states, piecol = piecolors)
legend("topleft", legend = colnames(corhmm_model_2$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(corhmm_model_2$phy, show.tip.label = FALSE)
tiplabels(pie = corhmm_model_2$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model_2$states, piecol = piecolors)
legend("topleft", legend = colnames(corhmm_model_2$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
plot(dredge_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
corhmm_model_2$AIC - corhmm_model$AIC
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
dredge_model$states[1,]
corhmm_model$states[1,]
round(corhmm_model$states[1,],3)
dredge_model
corhmm_model
round(corhmm_model$solution, 3)
round(dred$solution, 3)
round(dredge_model$solution, 3)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus advertisement | Multimale mating")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus advertisement | Multimale mating")
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus adv | mm mating")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus adv | mm mating")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus | Multimale")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus | Multimale")
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "Estrus | Multimale", adj = 1)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text("topleft", "poo")
dredge_model$phy
text(x = 0, y = 60, label = "poo")
text(x = 1, y = 60, label = "poo")
text(x = 2, y = 60, label = "poo")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = 2, y = 62, label = "poo")
text(x = 2, y = 61, label = "poo")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = 2, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
?text
text(x = 2, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=1)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = 2, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=1)
text(x = 2, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = 2, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = 0, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
text(x = -0.25, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -0.25, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
text(x = -0.5, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -1, y = 61, label = "Estrus advertisement | Multimale mating", cex = 0.75, adj=0)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -1, y = 61.5, label = "Estrus advertisement | Multimale mating",
cex = 0.75, adj=0)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -1, y = 61.5, label = "Estrus display | Multimale mating",
cex = 0.75, adj=0)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
profile_results_corhmm_2 <- get_batch_profile_lik(corhmm_model_2, dredge = FALSE,
range_factor = 100, n_points = 50, verbose = TRUE, ncores = 10)
plot_batch_profile_lik(profile_results_corhmm_2)
plot_batch_profile_lik(profile_results_dredge)
plot_batch_profile_lik(profile_results_corhmm)
plot_batch_profile_lik(profile_results_dredge)
profile_results_corhmm
profile_results_dredge$`0|1 -> 0|0`
profile_results_dredge$`0|1 -> 0|0`$profile_table
plot_batch_profile_lik(profile_results_corhmm)
dev.off()
RColorBrewer::display.brewer.all()
piecolors <- RColorBrewer::brewer.pal(4, "Paired")
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(dredge_model$phy, show.tip.label = FALSE)
tiplabels(pie = dredge_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = dredge_model$states, piecol = piecolors)
legend("topleft", legend = colnames(dredge_model$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -1, y = 61.5, label = "Estrus display | Multimale mating",
cex = 0.75, adj=0)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
corhmm_model <- corHMM(phy, data, 1, model = "ARD", root.p = "maddfitz", collapse = FALSE, nstarts = 10, n.cores = 10)
dredge_model
corhmm_model
0.01393149/0.04538592
0.04538592/0.01393149
plot_batch_profile_lik(profile_results_corhmm)
corhmm_model$index.mat
corhmm_model$index.mat
?ancRECON
p <- sapply(1:max(corhmm_model$index.mat, na.rm = TRUE), function(x)
na.omit(c(corhmm_model$solution))[na.omit(c(corhmm_model$index.mat) == x)][1])
p
corhmm_model$solution
corhmm_model$index.mat
corhmm_model$solution[corhmm_model$index.mat]
corhmm_model$solution
corhmm_model$index.mat
corhmm_model$solution[!is.na(corhmm_model$index.mat)]
p <- corhmm_model$solution[!is.na(corhmm_model$index.mat)]
corhmm_model_3 <- corHMM(phy, data, 1, root.p = "maddfitz", collapse = FALSE, rate.mat = corhmm_model$index.mat, p = p)
corhmm_model_3
corhmm_model
p[4] <- p[4]*100
p
corhmm_model_3 <- corHMM(phy, data, 1, root.p = "maddfitz", collapse = FALSE, rate.mat = corhmm_model$index.mat, p = p)
corhmm_model_3
corhmm_model
corhmm_model_3$states[1,]
corhmm_model$states[1,]
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(corhmm_model_3$phy, show.tip.label = FALSE)
tiplabels(pie = corhmm_model_3$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model_3$states, piecol = piecolors)
legend("topleft", legend = colnames(corhmm_model_3$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -1, y = 61.5, label = "Estrus display | Multimale mating",
cex = 0.75, adj=0)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
p <- corhmm_model$solution[!is.na(corhmm_model$index.mat)]
p[4] <- p[4]*1000
corhmm_model_3 <- corHMM(phy, data, 1, root.p = "maddfitz", collapse = FALSE, rate.mat = corhmm_model$index.mat, p = p)
par(mar=c(.1,.1,.1,.1), mfrow=c(1,2))
plot(corhmm_model_3$phy, show.tip.label = FALSE)
tiplabels(pie = corhmm_model_3$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model_3$states, piecol = piecolors)
legend("topleft", legend = colnames(corhmm_model_3$states),
pch=21, pt.bg = piecolors, cex = 0.75, bty="n", title = "")
text(x = -1, y = 61.5, label = "Estrus display | Multimale mating",
cex = 0.75, adj=0)
plot(corhmm_model$phy, show.tip.label = FALSE, direction = "leftwards")
tiplabels(pie = corhmm_model$tip.states, cex=0.5, piecol = piecolors)
nodelabels(pie = corhmm_model$states, piecol = piecolors)
corhmm_model
corhmm_model_3
corhmm_model
p
